define(["logBee"],function(a){function r(e,t){if(!e)throw new Error("fileName is null");if(!t)throw new Error("content is null");switch(a.getFileExtension(e)){case"json":var r=t;try{var n=JSON.parse(r);return JSON.stringify(n,null,2)}catch(e){return!1}return;case"xml":r=t;try{var l=(new DOMParser).parseFromString(r,"application/xml"),s=(new DOMParser).parseFromString(['<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','  <xsl:strip-space elements="*"/>','  <xsl:template match="para[content-style][not(text())]">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">','    <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',"  </xsl:template>",'  <xsl:output indent="yes"/>',"</xsl:stylesheet>"].join("\n"),"application/xml"),i=new XSLTProcessor,o=(i.importStylesheet(s),i.transformToDocument(l));return(new XMLSerializer).serializeToString(o)}catch(e){return r}return}return t}function n(r,e){if(!r)return Promise.reject(new Error("content is null"));e=a.getFileExtension(e=e||"");const n=-1<["json"].indexOf(e)?"json":-1<["xml","html","htm"].indexOf(e)?"xml":-1<["js"].indexOf(e)?"javascript":-1<["yaml","yml"].indexOf(e)?"yaml":void 0;return new Promise((t,e)=>{require(["hljs"],function(e){e=n?e.highlight(r,{language:n}):e.highlightAuto(r);return t(e.value)})})}return{formatContent:r,formatAndHighlightContent:function(e,t){return e?t?!1===(e=r(t,e))?Promise.resolve(!1):n(e,t):Promise.reject(new Error("fileName is null")):Promise.reject(new Error("content is null"))},highlightContent:function(e,t){return e?n(e,t):Promise.reject(new Error("content is null"))}}});