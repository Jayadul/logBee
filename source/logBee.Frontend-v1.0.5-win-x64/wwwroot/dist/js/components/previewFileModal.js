define(["logBee","jquery","js/components/Modal","js/templates","bootstrap","js/formatFileContent"],function(o,s,r,i,t,a){function e(a){a=s.extend(!0,{},l,a);const n=t.Button.getOrCreateInstance(a.srcElement);n.toggleDisabled(!0),s.get(a.url).done(t=>{var n,o,e;n=a.fileName,o=t,t=i.previewFileModal({fileName:n,content:o,usePreTagForContent:c(n)}),(e=new r).events.on(r.EVENT_TYPES.build,function(t){const e=t.instance;t.instance.getElement().on("shown.bs.tab",'[data-bs-toggle="tab"]',function(t){t=s(t.target).attr("aria-controls");/formatted-tab-content$/i.test(t)&&m(e,n,o)})}),e.buildFromHtml(t.html)}).always(function(t,e){"success"!==e&&o.showXhrErrorToast(t),n.toggleDisabled(!1)})}const l={url:"",fileName:"File",srcElement:null},c=function(t){t=o.getFileExtension(t);return-1<["txt","log","html","htm","js"].indexOf(t)},m=function(t,e,n){if(!0!==t._formatted){const o=t.getElement().find("[data-formatted-content-container]");a.formatAndHighlightContent(n,e).then(t=>{!1===t?o.text("Formatting this file content is not supported"):(t=s("<pre class='fs--1' />").html(t),o.html(t))}).catch(t=>{o.text("There was an error formatting the content: "+t.message)}),t._formatted=!0}};return new function(){this.open=e}});