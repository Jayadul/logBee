define(["logBee","jquery","ko","chart-js","luxon"],function(n,o,i,l,c){function r(t,a){const e=t.attr("data-id");if((a=a.applications.find(t=>t.application.applicationId===e)).applicationData){for(var t=t.find("[data-usage-chart]"),n=a.usageChartData,a=t[0],o=[],i=0,r=n.intervals.length;i<r;i++)o.push(n.intervals[i].from);a=a.getContext("2d"),new l(a,{type:"bar",options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{intersect:!1,mode:"index",callbacks:{title:function(t,a){t=t[0].label;return""+c.DateTime.fromISO(t).toFormat("MMMM yyyy")}}}},scales:{y:{beginAtZero:!0},x:{ticks:{callback:function(t){t=this.getLabelForValue(t);return c.DateTime.fromISO(t).toFormat("MMM yy")}}}},elements:{point:{radius:0},line:{borderWidth:2}}},data:{labels:o,datasets:[{label:"Created",fill:!0,backgroundColor:"rgb(54, 162, 235)",borderColor:"rgb(54, 162, 235)",data:n.intervals.map(function(t){return t.value.requestLogs.createdCount})},{label:"Throttled",fill:!0,backgroundColor:"rgb(253, 220, 142)",borderColor:"rgb(253, 220, 142)",data:n.intervals.map(function(t){return t.value.requestLogs.throttledCount})},{label:"Plan limit exceeded",fill:!0,backgroundColor:"rgb(255, 143, 0)",borderColor:"rgb(255, 143, 0)",data:n.intervals.map(function(t){return t.value.requestLogs.limitExceededCount})}]}})}}return{init:function(a){var t=n.htmlDecode(o("#page-model").html());const e=JSON.parse(t);t={applications:e.applications.map(t=>({application:t.application,applicationData:t.applicationData}))};i.applyBindings(t,o("#content")[0]),o("#content").find("[data-time-ago]").each(function(){n.timeAgoTag(o(this))}),o("#content").find("[data-application]").each(function(){r(o(this),e)}),o("#content").on("click","[data-create-application-button]",function(t){t.preventDefault(),require(["js/account/createApplicationModal"],function(t){t.open({organizationId:a})})})}}});