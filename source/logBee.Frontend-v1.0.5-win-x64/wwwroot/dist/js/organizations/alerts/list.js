define(["logBee","jquery","ko","bootstrap","js/formatFileContent","beautifier"],function(s,r,e,t,o,c){const d={};return{init:function(i){var t=s.htmlDecode(r("#page-model").html()),t=JSON.parse(t);const a={alerts:e.observableArray(t.alerts)};e.applyBindings(a,r("#content")[0]),r("#content").find("[data-javascript-popover]").each(function(){const e=r(this);const n=r(this).closest("tr").attr("data-id");var t=a.alerts().find(t=>t.id===n).javascriptCode;o.highlightContent(t).then(t=>{t&&(t=`<pre class='fs--1'>${t}</pre>`,t=s.bindPopover(e,t),d[n]=t)})}),r("#content").find("[data-time-ago]").each(function(){s.timeAgoTag(r(this))}),r("#content").on("click","[data-delete-alert]",function(t){t.preventDefault();const n=r(this).closest("tr").attr("data-id");require(["js/organizations/alerts/deleteAlertModal"],function(t){return t.open({organizationId:i,alertId:n,onComplete:function(t,e){d[n]&&d[n].dispose(),a.alerts.remove(t=>t.id===n),e.close(),s.showToast({body:t.name+" alert has been deleted",type:"success"})}})})}),r("#content").find("[data-format-code]").each(function(){const e=r(this);const n=function(t){try{return c.js_beautify(t,{max_preserve_newlines:2})}catch(t){}return t}(s.htmlDecode(e.html()));o.highlightContent(n).then(t=>{t?e.html(t):e.html(n)})}),r("#content").on("change","input[name=isEnabled]",function(){var t=r(this);clearTimeout(t.data("changeStateTimeout"));const o=t.closest("tr").attr("data-id");t.data("changeStateTimeout",setTimeout(function(){{var t=o,e=i,n=r("#content").find("[data-alerts-table]").find(`tr[data-id='${t}']`).find("input[name=isEnabled]").is(":checked");const a=n?"enabled":"disabled";r.post("/Organizations/ChangeAlertState",{alertId:t,organizationId:e,isEnabled:n}).done(t=>{s.showToast({body:t.name+" alert has been "+a,type:"success"})}).fail(function(t){s.showXhrErrorToast(t,!0)})}},500))}),r("#content").find("[data-container]").removeClass("d-none")}}});